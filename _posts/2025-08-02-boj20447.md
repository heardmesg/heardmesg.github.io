---
title:  "백준28665 Лемурьи вечеринки (Prime) "
date:   2025-08-02 11:54:00
categories:
- PS
tags:
- PS
---

### 문제 링크
* https://icpc.me/28665

### 문제 출처
* Internet Olympiads in Informatics > 2020-2021 Season November 28, 2020 > Basic C번

### 사용 알고리즘
* 조합론

### 시간복잡도
* $O(k + n)$

### 풀이

$k$종이 각 두마리씩 있으니까 총 뽑을 수 있는 0부터 $2k$마리이니, 아니라면 0을 출력해줍니다.

일단 $0!$부터 $(2k)!$까지 전처리해서, 모듈로 곱셈 역원으로 역 팩토리얼도 만들어서 이항계수르 $O(1)$에 계산할 수 있습니다.

$m$을 2마리 뽑는 종의 개수라고 가정하면, $2m + l = n$이고, $l \le k - m$이여야 하니, $m$의 최소값은 $max(0,n-k)$, 최댓값은 $⌊n \div 2⌋$입니다.

$C(k,m)$을 $k$종중 $m$종을 선택해 2마리씩 뽑는 경우라 가정했을때, $C(k-m,1)$은 남은 $k-m$종중 $l$종을 선택해 1마리씩 뽑는 경우라 가정할 수 있습니다. 그 둘을 곱하면 $2 \times m + 1 \times x = n$을 구성하는 서로다른 멀티셋의 개수라고 가정할 수 있습니다.

